<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inazuma Eleven - Loading</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; overflow: hidden; background: #1a1a2e; }
        #background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url('loading_background.png'); background-size: cover; background-position: center; z-index: 1; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.7)); z-index: 2; }
        #content { position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); width: 600px; z-index: 3; text-align: center; }
        #title { font-size: 48px; font-weight: bold; color: #fff; text-shadow: 0 4px 10px rgba(0,0,0,0.8); margin-bottom: 10px; }
        #subtitle { font-size: 20px; color: #88ccff; margin-bottom: 40px; }
        #progress-container { width: 100%; height: 8px; background: rgba(255,255,255,0.2); border-radius: 10px; overflow: hidden; margin-bottom: 15px; }
        #progress-bar { width: 0%; height: 100%; background: linear-gradient(90deg, #4facfe, #00f2fe); transition: width 0.3s ease; }
        #status { font-size: 16px; color: #fff; }
        #logo { position: fixed; top: 30px; left: 30px; font-size: 60px; z-index: 4; }
        #server-info { position: fixed; top: 30px; right: 30px; color: #fff; text-align: right; z-index: 4; }
        #server-name { font-size: 24px; font-weight: bold; }
    </style>
</head>
<body>
    <audio id="loading-music" loop>
        <source src="https://elyox93800-design.github.io/mon-loading-gmod/loading_sound.mp3" type="audio/mpeg">
    </audio>

    <div id="background"></div>
    <div id="overlay"></div>
    <div id="logo">⚽</div>

    <div id="server-info">
        <div id="server-name">INAZUMA ELEVEN</div>
        <div>Map: <span id="map-name">Loading...</span></div>
    </div>

    <div id="content">
        <div id="title">INAZUMA ELEVEN</div>
        <div id="subtitle">Rejoins l'équipe !</div>
        <div id="progress-container"><div id="progress-bar"></div></div>
        <div id="status">Chargement...</div>
    </div>

    <script>
        var music = document.getElementById('loading-music');
        music.volume = 0.02;

        // Fonction pour forcer le démarrage
        function startMusic() {
            music.play().then(function() {
                console.log("Musique OK");
            }).catch(function(e) {
                console.log("En attente d'interaction...");
            });
        }

        // GMod appelle cette fonction dès la connexion
        function GameDetails(servername, serverurl, mapname, maxplayers, steamid, gamemode) {
            document.getElementById('server-name').textContent = servername;
            document.getElementById('map-name').textContent = mapname;
            startMusic(); // Tentative 1
        }

        // Tentative de secours au clic (pour le navigateur)
        window.addEventListener('click', function() {
            startMusic();
        });

        // Tentative de secours automatique toutes les secondes
        var forcePlay = setInterval(function() {
            if (!music.paused) {
                clearInterval(forcePlay);
            } else {
                startMusic();
            }
        }, 1000);

        function SetStatusChanged(status) { document.getElementById('status').textContent = status; }
        function DownloadingFile(fileName) { document.getElementById('status').textContent = 'Téléchargement: ' + fileName; }
        
        let progress = 0;
        setInterval(function() {
            if (progress < 95) {
                progress += Math.random() * 0.5;
                document.getElementById('progress-bar').style.width = progress + '%';
            }
        }, 100);
    </script>
</body>
</html>
